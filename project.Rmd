---
title: "project"
author: "Eric Friesth"
date: "11/21/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Gun Violence incidences recorded in the US from 2013 to 2018

### Data Cleaning

```{r}
#Initial cleaning was done using MS Excel, we dropped columns that we weren't planning to use (Address, house district, senate district, part2-5_age) and removed rows with empty cells.
data = read.csv('gun-violence-202.csv')
head(data)
str(data)


#Changing data type for date from factor to date

data$date <- as.Date(data$date, format = "%m/%d/%Y")
#head(data)
#Date format is in YYYY-MM-DD

#Changing the data type for age from factor to int
data$part1_age <- as.integer(data$part1_age)
#head(data)
#str(data)

#Next, we drop rows with NA values using na.omit

data_clean <- na.omit(data)
head(data_clean, 10)

# Finally, we noticed in our two factor variables, state and city_or_county, had levels "" that had to be removed as they were unnecessary

# We did this using the following code to drop levels

data_clean$state[data_clean$state == ""] = NA
data_clean$state = droplevels(data_clean$state)
str(data_clean)

data_clean$city_or_county[data_clean$city_or_county == ""] = NA
data_clean$city_or_county = droplevels(data_clean$city_or_county)
str(data_clean)

```

### Data Visualization

```{r}

library(tidyverse)
library(ggmap)
library(sf)
library(mapview)
library(RColorBrewer)


map_bounds = c(left = -125, bottom = 25, right = -65, top = 50)

data_clean.map = get_stamenmap(map_bounds, zoom = 15, maptype = "toner-lite")

data_clean.map = ggmap(data_clean.map, extent = "device", legend = "none")

data_clean.map = data_clean.map + stat_density2d(data=data_clean, aes(x = data_clean$longitude, y = data_clean$latitude, fill = ..level.., alpha = ..level..), geom="polygon")

data_clean.map = data_clean.map + scale_fill_gradientn(colours = rev(brewer.pal(7, "Spectral")))


data_clean.map = data_clean.map + theme_bw()

ggsave(filename = "D:\\Documents\\ds202_project\\data_clean.png")





ggplot(data_clean, aes(x = state, y = sum(n_killed))) + geom_bar(stat = "identity") + theme(axis.text.x = element_text(angle=90, hjust=1))

ggplot(data_clean, aes(x = part1_age, y = sum(n_killed), bins = 10)) + geom_histogram(stat = "identity")


```



















